(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const vr="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(vr);let Me=!1,pr=!1;function hr(){Me=!0}hr();const _r=1,gr=2,mn=4,mr=8,xr=16,br=2,B=Symbol(),Le=!1;var xn=Array.isArray,yr=Array.prototype.indexOf,De=Array.from,bn=Object.defineProperty,fe=Object.getOwnPropertyDescriptor,Tr=Object.getOwnPropertyDescriptors,wr=Object.prototype,Sr=Array.prototype,yn=Object.getPrototypeOf,on=Object.isExtensible;const Ct=()=>{};function Er(t){return t()}function ke(t){for(var e=0;e<t.length;e++)t[e]()}function Tn(){var t,e,n=new Promise((r,s)=>{t=r,e=s});return{promise:n,resolve:t,reject:e}}const j=2,wn=4,Ne=8,kr=1<<24,xt=16,bt=32,Bt=64,Re=128,it=512,U=1024,G=2048,ct=4096,Q=8192,Mt=16384,ze=32768,Jt=65536,ln=1<<17,Sn=1<<18,ne=1<<19,En=1<<20,_t=1<<25,Ft=32768,je=1<<21,Ke=1<<22,Dt=1<<23,ue=Symbol("$state"),Zt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ar(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function $r(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Cr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Mr(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Dr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Nr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Rr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ir(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Pr(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function Or(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function kn(t){return t===this.v}function An(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function $n(t){return!An(t,this.v)}let L=null;function Xt(t){L=t}function yt(t,e=!1,n){L={p:L,i:!1,c:null,e:null,s:t,x:null,l:Me&&!e?{s:null,u:null,$:[]}:null}}function Tt(t){var e=L,n=e.e;if(n!==null){e.e=null;for(var r of n)Hn(r)}return e.i=!0,L=e.p,{}}function _e(){return!Me||L!==null&&L.l===null}let Qt=[];function Fr(){var t=Qt;Qt=[],ke(t)}function Ie(t){if(Qt.length===0){var e=Qt;queueMicrotask(()=>{e===Qt&&Fr()})}Qt.push(t)}function Cn(t){var e=k;if(e===null)return E.f|=Dt,t;if((e.f&ze)===0){if((e.f&Re)===0)throw t;e.b.error(t)}else te(t,e)}function te(t,e){for(;e!==null;){if((e.f&Re)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t}const we=new Set;let M=null,rt=null,ot=[],Ye=null,Be=!1;class ft{committed=!1;current=new Map;previous=new Map;#t=new Set;#e=new Set;#r=0;#n=0;#l=null;#a=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){ot=[],this.apply();var n={parent:null,effect:null,effects:[],render_effects:[]};for(const r of e)this.#i(r,n);this.is_fork||this.#u(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects)):(M=null,fn(n.render_effects),fn(n.effects),this.#l?.resolve()),rt=null}#i(e,n){e.f^=U;for(var r=e.first;r!==null;){var s=r.f,a=(s&(bt|Bt))!==0,l=a&&(s&U)!==0,f=l||(s&Q)!==0||this.skipped_effects.has(r);if((r.f&Re)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[]}),!f&&r.fn!==null){a?r.f^=U:(s&wn)!==0?n.effects.push(r):me(r)&&((r.f&xt)!==0&&this.#a.add(r),pe(r));var i=r.first;if(i!==null){r=i;continue}}var o=r.parent;for(r=r.next;r===null&&o!==null;)o===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),n=n.parent),r=o.next,o=o.parent}}#o(e){for(const n of e)(n.f&G)!==0?this.#a.add(n):(n.f&ct)!==0&&this.#s.add(n),this.#f(n.deps),q(n,U)}#f(e){if(e!==null)for(const n of e)(n.f&j)===0||(n.f&Ft)===0||(n.f^=Ft,this.#f(n.deps))}capture(e,n){this.previous.has(e)||this.previous.set(e,n),(e.f&Dt)===0&&(this.current.set(e,e.v),rt?.set(e,e.v))}activate(){M=this,this.apply()}deactivate(){M===this&&(M=null,rt=null)}flush(){if(this.activate(),ot.length>0){if(Lr(),M!==null&&M!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#e)e(this);this.#e.clear()}#u(){if(this.#n===0){for(const e of this.#t)e();this.#t.clear()}this.#r===0&&this.#c()}#c(){if(we.size>1){this.previous.clear();var e=rt,n=!0,r={parent:null,effect:null,effects:[],render_effects:[]};for(const a of we){if(a===this){n=!1;continue}const l=[];for(const[i,o]of this.current){if(a.current.has(i))if(n&&o!==a.current.get(i))a.current.set(i,o);else continue;l.push(i)}if(l.length===0)continue;const f=[...a.current.keys()].filter(i=>!this.current.has(i));if(f.length>0){var s=ot;ot=[];const i=new Set,o=new Map;for(const u of l)Mn(u,f,i,o);if(ot.length>0){M=a,a.apply();for(const u of ot)a.#i(u,r);a.deactivate()}ot=s}}M=null,rt=e}this.committed=!0,we.delete(this)}increment(e){this.#r+=1,e&&(this.#n+=1)}decrement(e){this.#r-=1,e&&(this.#n-=1),this.revive()}revive(){for(const e of this.#a)this.#s.delete(e),q(e,G),Lt(e);for(const e of this.#s)q(e,ct),Lt(e);this.flush()}oncommit(e){this.#t.add(e)}ondiscard(e){this.#e.add(e)}settled(){return(this.#l??=Tn()).promise}static ensure(){if(M===null){const e=M=new ft;we.add(M),ft.enqueue(()=>{M===e&&e.flush()})}return M}static enqueue(e){Ie(e)}apply(){}}function Lr(){var t=Pt;Be=!0;var e=null;try{var n=0;for($e(!0);ot.length>0;){var r=ft.ensure();if(n++>1e3){var s,a;jr()}r.process(ot),Nt.clear()}}finally{Be=!1,$e(t),Ye=null}}function jr(){try{Dr()}catch(t){te(t,Ye)}}let pt=null;function fn(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(Mt|Q))===0&&me(r)&&(pt=new Set,pe(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Yn(r):r.fn=null),pt?.size>0)){Nt.clear();for(const s of pt){if((s.f&(Mt|Q))!==0)continue;const a=[s];let l=s.parent;for(;l!==null;)pt.has(l)&&(pt.delete(l),a.push(l)),l=l.parent;for(let f=a.length-1;f>=0;f--){const i=a[f];(i.f&(Mt|Q))===0&&pe(i)}}pt.clear()}}pt=null}}function Mn(t,e,n,r){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const s of t.reactions){const a=s.f;(a&j)!==0?Mn(s,e,n,r):(a&(Ke|xt))!==0&&(a&G)===0&&Dn(s,e,r)&&(q(s,G),Lt(s))}}function Dn(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const s of t.deps){if(e.includes(s))return!0;if((s.f&j)!==0&&Dn(s,e,n))return n.set(s,!0),!0}return n.set(t,!1),!1}function Lt(t){for(var e=Ye=t;e.parent!==null;){e=e.parent;var n=e.f;if(Be&&e===k&&(n&xt)!==0&&(n&Sn)===0)return;if((n&(Bt|bt))!==0){if((n&U)===0)return;e.f^=U}}ot.push(e)}function Br(t){let e=0,n=jt(0),r;return()=>{de()&&(c(n),es(()=>(e===0&&(r=tn(()=>t(()=>ce(n)))),e+=1,()=>{Ie(()=>{e-=1,e===0&&(r?.(),r=void 0,ce(n))})})))}}var Ur=Jt|ne|Re;function qr(t,e,n){new Vr(t,e,n)}class Vr{parent;#t=!1;#e;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#f=null;#u=null;#c=0;#d=0;#p=!1;#v=null;#x=Br(()=>(this.#v=jt(this.#c),()=>{this.#v=null}));constructor(e,n,r){this.#e=e,this.#n=n,this.#l=r,this.parent=k.b,this.#t=!!this.#n.pending,this.#a=Je(()=>{k.b=this;{var s=this.#g();try{this.#s=et(()=>r(s))}catch(a){this.error(a)}this.#d>0?this.#_():this.#t=!1}return()=>{this.#u?.remove()}},Ur)}#b(){try{this.#s=et(()=>this.#l(this.#e))}catch(e){this.error(e)}this.#t=!1}#y(){const e=this.#n.pending;e&&(this.#i=et(()=>e(this.#e)),ft.enqueue(()=>{var n=this.#g();this.#s=this.#h(()=>(ft.ensure(),et(()=>this.#l(n)))),this.#d>0?this.#_():(It(this.#i,()=>{this.#i=null}),this.#t=!1)}))}#g(){var e=this.#e;return this.#t&&(this.#u=Rt(),this.#e.before(this.#u),e=this.#u),e}is_pending(){return this.#t||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#h(e){var n=k,r=E,s=L;dt(this.#a),K(this.#a),Xt(this.#a.ctx);try{return e()}catch(a){return Cn(a),null}finally{dt(n),K(r),Xt(s)}}#_(){const e=this.#n.pending;this.#s!==null&&(this.#f=document.createDocumentFragment(),this.#f.append(this.#u),Qn(this.#s,this.#f)),this.#i===null&&(this.#i=et(()=>e(this.#e)))}#m(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(e);return}this.#d+=e,this.#d===0&&(this.#t=!1,this.#i&&It(this.#i,()=>{this.#i=null}),this.#f&&(this.#e.before(this.#f),this.#f=null))}update_pending_count(e){this.#m(e),this.#c+=e,this.#v&&ee(this.#v,this.#c)}get_effect_pending(){return this.#x(),c(this.#v)}error(e){var n=this.#n.onerror;let r=this.#n.failed;if(this.#p||!n&&!r)throw e;this.#s&&(Y(this.#s),this.#s=null),this.#i&&(Y(this.#i),this.#i=null),this.#o&&(Y(this.#o),this.#o=null);var s=!1,a=!1;const l=()=>{if(s){Or();return}s=!0,a&&Pr(),ft.ensure(),this.#c=0,this.#o!==null&&It(this.#o,()=>{this.#o=null}),this.#t=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#p=!1,et(()=>this.#l(this.#e)))),this.#d>0?this.#_():this.#t=!1};var f=E;try{K(null),a=!0,n?.(e,l),a=!1}catch(i){te(i,this.#a&&this.#a.parent)}finally{K(f)}r&&Ie(()=>{this.#o=this.#h(()=>{ft.ensure(),this.#p=!0;try{return et(()=>{r(this.#e,()=>e,()=>l)})}catch(i){return te(i,this.#a.parent),null}finally{this.#p=!1}})})}}function Wr(t,e,n,r){const s=_e()?Pe:Nn;if(n.length===0&&t.length===0){r(e.map(s));return}var a=M,l=k,f=Hr();function i(){Promise.all(n.map(o=>zr(o))).then(o=>{f();try{r([...e.map(s),...o])}catch(u){(l.f&Mt)===0&&te(u,l)}a?.deactivate(),Ae()}).catch(o=>{te(o,l)})}t.length>0?Promise.all(t).then(()=>{f();try{return i()}finally{a?.deactivate(),Ae()}}):i()}function Hr(){var t=k,e=E,n=L,r=M;return function(a=!0){dt(t),K(e),Xt(n),a&&r?.activate()}}function Ae(){dt(null),K(null),Xt(null)}function Pe(t){var e=j|G,n=E!==null&&(E.f&j)!==0?E:null;return k!==null&&(k.f|=ne),{ctx:L,deps:null,effects:null,equals:kn,f:e,fn:t,reactions:null,rv:0,v:B,wv:0,parent:n??k,ac:null}}function zr(t,e){let n=k;n===null&&Ar();var r=n.b,s=void 0,a=jt(B),l=!E,f=new Map;return ts(()=>{var i=Tn();s=i.promise;try{Promise.resolve(t()).then(i.resolve,i.reject).then(()=>{o===M&&o.committed&&o.deactivate(),Ae()})}catch(d){i.reject(d),Ae()}var o=M;if(l){var u=!r.is_pending();r.update_pending_count(1),o.increment(u),f.get(o)?.reject(Zt),f.delete(o),f.set(o,i)}const v=(d,p=void 0)=>{if(o.activate(),p)p!==Zt&&(a.f|=Dt,ee(a,p));else{(a.f&Dt)!==0&&(a.f^=Dt),ee(a,d);for(const[m,y]of f){if(f.delete(m),m===o)break;y.reject(Zt)}}l&&(r.update_pending_count(-1),o.decrement(u))};i.promise.then(v,d=>v(null,d||"unknown"))}),Wn(()=>{for(const i of f.values())i.reject(Zt)}),new Promise(i=>{function o(u){function v(){u===s?i(a):o(s)}u.then(v,v)}o(s)})}function ht(t){const e=Pe(t);return Jn(e),e}function Nn(t){const e=Pe(t);return e.equals=$n,e}function Rn(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)Y(e[n])}}function Kr(t){for(var e=t.parent;e!==null;){if((e.f&j)===0)return(e.f&Mt)===0?e:null;e=e.parent}return null}function Ge(t){var e,n=k;dt(Kr(t));try{t.f&=~Ft,Rn(t),e=nr(t)}finally{dt(n)}return e}function In(t){var e=Ge(t);if(t.equals(e)||(M?.is_fork||(t.v=e),t.wv=tr()),!re)if(rt!==null)(de()||M?.is_fork)&&rt.set(t,e);else{var n=(t.f&it)===0?ct:U;q(t,n)}}let Ue=new Set;const Nt=new Map;let Pn=!1;function jt(t,e){var n={f:0,v:t,reactions:null,equals:kn,rv:0,wv:0};return n}function Et(t,e){const n=jt(t);return Jn(n),n}function On(t,e=!1,n=!0){const r=jt(t);return e||(r.equals=$n),Me&&n&&L!==null&&L.l!==null&&(L.l.s??=[]).push(r),r}function At(t,e,n=!1){E!==null&&(!ut||(E.f&ln)!==0)&&_e()&&(E.f&(j|xt|Ke|ln))!==0&&!gt?.includes(t)&&Ir();let r=n?oe(e):e;return ee(t,r)}function ee(t,e){if(!t.equals(e)){var n=t.v;re?Nt.set(t,e):Nt.set(t,n),t.v=e;var r=ft.ensure();r.capture(t,n),(t.f&j)!==0&&((t.f&G)!==0&&Ge(t),q(t,(t.f&it)!==0?U:ct)),t.wv=tr(),Fn(t,G),_e()&&k!==null&&(k.f&U)!==0&&(k.f&(bt|Bt))===0&&(tt===null?ss([t]):tt.push(t)),!r.is_fork&&Ue.size>0&&!Pn&&Yr()}return e}function Yr(){Pn=!1;var t=Pt;$e(!0);const e=Array.from(Ue);try{for(const n of e)(n.f&U)!==0&&q(n,ct),me(n)&&pe(n)}finally{$e(t)}Ue.clear()}function ce(t){At(t,t.v+1)}function Fn(t,e){var n=t.reactions;if(n!==null)for(var r=_e(),s=n.length,a=0;a<s;a++){var l=n[a],f=l.f;if(!(!r&&l===k)){var i=(f&G)===0;if(i&&q(l,e),(f&j)!==0){var o=l;rt?.delete(o),(f&Ft)===0&&(f&it&&(l.f|=Ft),Fn(o,ct))}else i&&((f&xt)!==0&&pt!==null&&pt.add(l),Lt(l))}}}function oe(t){if(typeof t!="object"||t===null||ue in t)return t;const e=yn(t);if(e!==wr&&e!==Sr)return t;var n=new Map,r=xn(t),s=Et(0),a=Ot,l=f=>{if(Ot===a)return f();var i=E,o=Ot;K(null),vn(a);var u=f();return K(i),vn(o),u};return r&&n.set("length",Et(t.length)),new Proxy(t,{defineProperty(f,i,o){(!("value"in o)||o.configurable===!1||o.enumerable===!1||o.writable===!1)&&Nr();var u=n.get(i);return u===void 0?u=l(()=>{var v=Et(o.value);return n.set(i,v),v}):At(u,o.value,!0),!0},deleteProperty(f,i){var o=n.get(i);if(o===void 0){if(i in f){const u=l(()=>Et(B));n.set(i,u),ce(s)}}else At(o,B),ce(s);return!0},get(f,i,o){if(i===ue)return t;var u=n.get(i),v=i in f;if(u===void 0&&(!v||fe(f,i)?.writable)&&(u=l(()=>{var p=oe(v?f[i]:B),m=Et(p);return m}),n.set(i,u)),u!==void 0){var d=c(u);return d===B?void 0:d}return Reflect.get(f,i,o)},getOwnPropertyDescriptor(f,i){var o=Reflect.getOwnPropertyDescriptor(f,i);if(o&&"value"in o){var u=n.get(i);u&&(o.value=c(u))}else if(o===void 0){var v=n.get(i),d=v?.v;if(v!==void 0&&d!==B)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return o},has(f,i){if(i===ue)return!0;var o=n.get(i),u=o!==void 0&&o.v!==B||Reflect.has(f,i);if(o!==void 0||k!==null&&(!u||fe(f,i)?.writable)){o===void 0&&(o=l(()=>{var d=u?oe(f[i]):B,p=Et(d);return p}),n.set(i,o));var v=c(o);if(v===B)return!1}return u},set(f,i,o,u){var v=n.get(i),d=i in f;if(r&&i==="length")for(var p=o;p<v.v;p+=1){var m=n.get(p+"");m!==void 0?At(m,B):p in f&&(m=l(()=>Et(B)),n.set(p+"",m))}if(v===void 0)(!d||fe(f,i)?.writable)&&(v=l(()=>Et(void 0)),At(v,oe(o)),n.set(i,v));else{d=v.v!==B;var y=l(()=>oe(o));At(v,y)}var h=Reflect.getOwnPropertyDescriptor(f,i);if(h?.set&&h.set.call(u,o),!d){if(r&&typeof i=="string"){var _=n.get("length"),x=Number(i);Number.isInteger(x)&&x>=_.v&&At(_,x+1)}ce(s)}return!0},ownKeys(f){c(s);var i=Reflect.ownKeys(f).filter(v=>{var d=n.get(v);return d===void 0||d.v!==B});for(var[o,u]of n)u.v!==B&&!(o in f)&&i.push(o);return i},setPrototypeOf(){Rr()}})}var un,Ln,jn,Bn;function Gr(){if(un===void 0){un=window,Ln=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;jn=fe(e,"firstChild").get,Bn=fe(e,"nextSibling").get,on(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),on(n)&&(n.__t=void 0)}}function Rt(t=""){return document.createTextNode(t)}function Ze(t){return jn.call(t)}function ge(t){return Bn.call(t)}function g(t,e){return Ze(t)}function Qe(t,e=!1){{var n=Ze(t);return n instanceof Comment&&n.data===""?ge(n):n}}function b(t,e=1,n=!1){let r=t;for(;e--;)r=ge(r);return r}function Zr(t){t.textContent=""}function Un(){return!1}function qn(t){var e=E,n=k;K(null),dt(null);try{return t()}finally{K(e),dt(n)}}function Vn(t){k===null&&(E===null&&Mr(),Cr()),re&&$r()}function Qr(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function wt(t,e,n){var r=k;r!==null&&(r.f&Q)!==0&&(t|=Q);var s={ctx:L,deps:null,nodes:null,f:t|G|it,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{pe(s),s.f|=ze}catch(f){throw Y(s),f}else e!==null&&Lt(s);var a=s;if(n&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&ne)===0&&(a=a.first,(t&xt)!==0&&(t&Jt)!==0&&a!==null&&(a.f|=Jt)),a!==null&&(a.parent=r,r!==null&&Qr(a,r),E!==null&&(E.f&j)!==0&&(t&Bt)===0)){var l=E;(l.effects??=[]).push(a)}return s}function de(){return E!==null&&!ut}function Wn(t){const e=wt(Ne,null,!1);return q(e,U),e.teardown=t,e}function cn(t){Vn();var e=k.f,n=!E&&(e&bt)!==0&&(e&ze)===0;if(n){var r=L;(r.e??=[]).push(t)}else return Hn(t)}function Hn(t){return wt(wn|En,t,!1)}function Jr(t){return Vn(),wt(Ne|En,t,!0)}function Xr(t){ft.ensure();const e=wt(Bt|ne,t,!0);return(n={})=>new Promise(r=>{n.outro?It(e,()=>{Y(e),r(void 0)}):(Y(e),r(void 0))})}function ts(t){return wt(Ke|ne,t,!0)}function es(t,e=0){return wt(Ne|e,t,!0)}function mt(t,e=[],n=[],r=[]){Wr(r,e,n,s=>{wt(Ne,()=>t(...s.map(c)),!0)})}function Je(t,e=0){var n=wt(xt|e,t,!0);return n}function et(t){return wt(bt|ne,t,!0)}function zn(t){var e=t.teardown;if(e!==null){const n=re,r=E;dn(!0),K(null);try{e.call(null)}finally{dn(n),K(r)}}}function Kn(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const s=n.ac;s!==null&&qn(()=>{s.abort(Zt)});var r=n.next;(n.f&Bt)!==0?n.parent=null:Y(n,e),n=r}}function ns(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&bt)===0&&Y(e),e=n}}function Y(t,e=!0){var n=!1;(e||(t.f&Sn)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(rs(t.nodes.start,t.nodes.end),n=!0),Kn(t,e&&!n),Ce(t,0),q(t,Mt);var r=t.nodes&&t.nodes.t;if(r!==null)for(const a of r)a.stop();zn(t);var s=t.parent;s!==null&&s.first!==null&&Yn(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function rs(t,e){for(;t!==null;){var n=t===e?null:ge(t);t.remove(),t=n}}function Yn(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function It(t,e,n=!0){var r=[];Gn(t,r,!0);var s=()=>{n&&Y(t),e&&e()},a=r.length;if(a>0){var l=()=>--a||s();for(var f of r)f.out(l)}else s()}function Gn(t,e,n){if((t.f&Q)===0){t.f^=Q;var r=t.nodes&&t.nodes.t;if(r!==null)for(const f of r)(f.is_global||n)&&e.push(f);for(var s=t.first;s!==null;){var a=s.next,l=(s.f&Jt)!==0||(s.f&bt)!==0&&(t.f&xt)!==0;Gn(s,e,l?n:!1),s=a}}}function Xe(t){Zn(t,!0)}function Zn(t,e){if((t.f&Q)!==0){t.f^=Q,(t.f&U)===0&&(q(t,G),Lt(t));for(var n=t.first;n!==null;){var r=n.next,s=(n.f&Jt)!==0||(n.f&bt)!==0;Zn(n,s?e:!1),n=r}var a=t.nodes&&t.nodes.t;if(a!==null)for(const l of a)(l.is_global||e)&&l.in()}}function Qn(t,e){if(t.nodes)for(var n=t.nodes.start,r=t.nodes.end;n!==null;){var s=n===r?null:ge(n);e.append(n),n=s}}let Pt=!1;function $e(t){Pt=t}let re=!1;function dn(t){re=t}let E=null,ut=!1;function K(t){E=t}let k=null;function dt(t){k=t}let gt=null;function Jn(t){E!==null&&(gt===null?gt=[t]:gt.push(t))}let W=null,Z=0,tt=null;function ss(t){tt=t}let Xn=1,ve=0,Ot=ve;function vn(t){Ot=t}function tr(){return++Xn}function me(t){var e=t.f;if((e&G)!==0)return!0;if(e&j&&(t.f&=~Ft),(e&ct)!==0){var n=t.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var a=n[s];if(me(a)&&In(a),a.wv>t.wv)return!0}(e&it)!==0&&rt===null&&q(t,U)}return!1}function er(t,e,n=!0){var r=t.reactions;if(r!==null&&!gt?.includes(t))for(var s=0;s<r.length;s++){var a=r[s];(a.f&j)!==0?er(a,e,!1):e===a&&(n?q(a,G):(a.f&U)!==0&&q(a,ct),Lt(a))}}function nr(t){var e=W,n=Z,r=tt,s=E,a=gt,l=L,f=ut,i=Ot,o=t.f;W=null,Z=0,tt=null,E=(o&(bt|Bt))===0?t:null,gt=null,Xt(t.ctx),ut=!1,Ot=++ve,t.ac!==null&&(qn(()=>{t.ac.abort(Zt)}),t.ac=null);try{t.f|=je;var u=t.fn,v=u(),d=t.deps;if(W!==null){var p;if(Ce(t,Z),d!==null&&Z>0)for(d.length=Z+W.length,p=0;p<W.length;p++)d[Z+p]=W[p];else t.deps=d=W;if(de()&&(t.f&it)!==0)for(p=Z;p<d.length;p++)(d[p].reactions??=[]).push(t)}else d!==null&&Z<d.length&&(Ce(t,Z),d.length=Z);if(_e()&&tt!==null&&!ut&&d!==null&&(t.f&(j|ct|G))===0)for(p=0;p<tt.length;p++)er(tt[p],t);return s!==null&&s!==t&&(ve++,tt!==null&&(r===null?r=tt:r.push(...tt))),(t.f&Dt)!==0&&(t.f^=Dt),v}catch(m){return Cn(m)}finally{t.f^=je,W=e,Z=n,tt=r,E=s,gt=a,Xt(l),ut=f,Ot=i}}function as(t,e){let n=e.reactions;if(n!==null){var r=yr.call(n,t);if(r!==-1){var s=n.length-1;s===0?n=e.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(e.f&j)!==0&&(W===null||!W.includes(e))&&(q(e,ct),(e.f&it)!==0&&(e.f^=it,e.f&=~Ft),Rn(e),Ce(e,0))}function Ce(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)as(t,n[r])}function pe(t){var e=t.f;if((e&Mt)===0){q(t,U);var n=k,r=Pt;k=t,Pt=!0;try{(e&(xt|kr))!==0?ns(t):Kn(t),zn(t);var s=nr(t);t.teardown=typeof s=="function"?s:null,t.wv=Xn;var a;Le&&pr&&(t.f&G)!==0&&t.deps}finally{Pt=r,k=n}}}function c(t){var e=t.f,n=(e&j)!==0;if(E!==null&&!ut){var r=k!==null&&(k.f&Mt)!==0;if(!r&&!gt?.includes(t)){var s=E.deps;if((E.f&je)!==0)t.rv<ve&&(t.rv=ve,W===null&&s!==null&&s[Z]===t?Z++:W===null?W=[t]:W.includes(t)||W.push(t));else{(E.deps??=[]).push(t);var a=t.reactions;a===null?t.reactions=[E]:a.includes(E)||a.push(E)}}}if(re){if(Nt.has(t))return Nt.get(t);if(n){var l=t,f=l.v;return((l.f&U)===0&&l.reactions!==null||sr(l))&&(f=Ge(l)),Nt.set(l,f),f}}else n&&(!rt?.has(t)||M?.is_fork&&!de())&&(l=t,me(l)&&In(l),Pt&&de()&&(l.f&it)===0&&rr(l));if(rt?.has(t))return rt.get(t);if((t.f&Dt)!==0)throw t.v;return t.v}function rr(t){if(t.deps!==null){t.f^=it;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&j)!==0&&(e.f&it)===0&&rr(e)}}function sr(t){if(t.v===B)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Nt.has(e)||(e.f&j)!==0&&sr(e))return!0;return!1}function tn(t){var e=ut;try{return ut=!0,t()}finally{ut=e}}const is=-7169;function q(t,e){t.f=t.f&is|e}function os(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ue in t)qe(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&ue in n&&qe(n)}}}function qe(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{qe(t[r],e)}catch{}const n=yn(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Tr(n);for(let s in r){const a=r[s].get;if(a)try{a.call(t)}catch{}}}}}const ar=new Set,Ve=new Set;function ir(t){for(var e=0;e<t.length;e++)ar.add(t[e]);for(var n of Ve)n(t)}let pn=null;function Se(t){var e=this,n=e.ownerDocument,r=t.type,s=t.composedPath?.()||[],a=s[0]||t.target;pn=t;var l=0,f=pn===t&&t.__root;if(f){var i=s.indexOf(f);if(i!==-1&&(e===document||e===window)){t.__root=e;return}var o=s.indexOf(e);if(o===-1)return;i<=o&&(l=i)}if(a=s[l]||t.target,a!==e){bn(t,"currentTarget",{configurable:!0,get(){return a||n}});var u=E,v=k;K(null),dt(null);try{for(var d,p=[];a!==null;){var m=a.assignedSlot||a.parentNode||a.host||null;try{var y=a["__"+r];y!=null&&(!a.disabled||t.target===a)&&y.call(a,t)}catch(h){d?p.push(h):d=h}if(t.cancelBubble||m===e||m===null)break;a=m}if(d){for(let h of p)queueMicrotask(()=>{throw h});throw d}}finally{t.__root=e,delete t.currentTarget,K(u),dt(v)}}}function ls(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function or(t,e){var n=k;n.nodes===null&&(n.nodes={start:t,end:e,a:null,t:null})}function V(t,e){var n=(e&br)!==0,r,s=!t.startsWith("<!>");return()=>{r===void 0&&(r=ls(s?t:"<!>"+t),r=Ze(r));var a=n||Ln?document.importNode(r,!0):r.cloneNode(!0);return or(a,a),a}}function en(){var t=document.createDocumentFragment(),e=document.createComment(""),n=Rt();return t.append(e,n),or(e,n),t}function O(t,e){t!==null&&t.before(e)}const fs=["touchstart","touchmove"];function us(t){return fs.includes(t)}function I(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function cs(t,e){return ds(t,e)}const Kt=new Map;function ds(t,{target:e,anchor:n,props:r={},events:s,context:a,intro:l=!0}){Gr();var f=new Set,i=v=>{for(var d=0;d<v.length;d++){var p=v[d];if(!f.has(p)){f.add(p);var m=us(p);e.addEventListener(p,Se,{passive:m});var y=Kt.get(p);y===void 0?(document.addEventListener(p,Se,{passive:m}),Kt.set(p,1)):Kt.set(p,y+1)}}};i(De(ar)),Ve.add(i);var o=void 0,u=Xr(()=>{var v=n??e.appendChild(Rt());return qr(v,{pending:()=>{}},d=>{if(a){yt({});var p=L;p.c=a}s&&(r.$$events=s),o=t(d,r)||{},a&&Tt()}),()=>{for(var d of f){e.removeEventListener(d,Se);var p=Kt.get(d);--p===0?(document.removeEventListener(d,Se),Kt.delete(d)):Kt.set(d,p)}Ve.delete(i),v!==n&&v.parentNode?.removeChild(v)}});return vs.set(o,u),o}let vs=new WeakMap;class ps{anchor;#t=new Map;#e=new Map;#r=new Map;#n=new Set;#l=!0;constructor(e,n=!0){this.anchor=e,this.#l=n}#a=()=>{var e=M;if(this.#t.has(e)){var n=this.#t.get(e),r=this.#e.get(n);if(r)Xe(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#e.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[a,l]of this.#t){if(this.#t.delete(a),a===e)break;const f=this.#r.get(l);f&&(Y(f.effect),this.#r.delete(l))}for(const[a,l]of this.#e){if(a===n||this.#n.has(a))continue;const f=()=>{if(Array.from(this.#t.values()).includes(a)){var o=document.createDocumentFragment();Qn(l,o),o.append(Rt()),this.#r.set(a,{effect:l,fragment:o})}else Y(l);this.#n.delete(a),this.#e.delete(a)};this.#l||!r?(this.#n.add(a),It(l,f,!1)):f()}}};#s=e=>{this.#t.delete(e);const n=Array.from(this.#t.values());for(const[r,s]of this.#r)n.includes(r)||(Y(s.effect),this.#r.delete(r))};ensure(e,n){var r=M,s=Un();if(n&&!this.#e.has(e)&&!this.#r.has(e))if(s){var a=document.createDocumentFragment(),l=Rt();a.append(l),this.#r.set(e,{effect:et(()=>n(l)),fragment:a})}else this.#e.set(e,et(()=>n(this.anchor)));if(this.#t.set(r,e),s){for(const[f,i]of this.#e)f===e?r.skipped_effects.delete(i):r.skipped_effects.add(i);for(const[f,i]of this.#r)f===e?r.skipped_effects.delete(i.effect):r.skipped_effects.add(i.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}function he(t,e,n=!1){var r=new ps(t),s=n?Jt:0;function a(l,f){r.ensure(l,f)}Je(()=>{var l=!1;e((f,i=!0)=>{l=!0,a(i,f)}),l||a(!1,null)},s)}function hs(t,e){return e}function _s(t,e,n){for(var r=[],s=e.length,a,l=e.length,f=0;f<s;f++){let v=e[f];It(v,()=>{if(a){if(a.pending.delete(v),a.done.add(v),a.pending.size===0){var d=t.outrogroups;We(De(a.done)),d.delete(a),d.size===0&&(t.outrogroups=null)}}else l-=1},!1)}if(l===0){var i=r.length===0&&n!==null;if(i){var o=n,u=o.parentNode;Zr(u),u.append(o),t.items.clear()}We(e,!i)}else a={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(a)}function We(t,e=!0){for(var n=0;n<t.length;n++)Y(t[n],e)}var hn;function nn(t,e,n,r,s,a=null){var l=t,f=new Map,i=(e&mn)!==0;if(i){var o=t;l=o.appendChild(Rt())}var u=null,v=Nn(()=>{var _=n();return xn(_)?_:_==null?[]:De(_)}),d,p=!0;function m(){h.fallback=u,gs(h,d,l,e,r),u!==null&&(d.length===0?(u.f&_t)===0?Xe(u):(u.f^=_t,le(u,null,l)):It(u,()=>{u=null}))}var y=Je(()=>{d=c(v);for(var _=d.length,x=new Set,T=M,w=Un(),S=0;S<_;S+=1){var P=d[S],C=r(P,S),D=p?null:f.get(C);D?(D.v&&ee(D.v,P),D.i&&ee(D.i,S),w&&T.skipped_effects.delete(D.e)):(D=ms(f,p?l:hn??=Rt(),P,C,S,s,e,n),p||(D.e.f|=_t),f.set(C,D)),x.add(C)}if(_===0&&a&&!u&&(p?u=et(()=>a(l)):(u=et(()=>a(hn??=Rt())),u.f|=_t)),!p)if(w){for(const[J,H]of f)x.has(J)||T.skipped_effects.add(H.e);T.oncommit(m),T.ondiscard(()=>{})}else m();c(v)}),h={effect:y,items:f,outrogroups:null,fallback:u};p=!1}function gs(t,e,n,r,s){var a=(r&mr)!==0,l=e.length,f=t.items,i=t.effect.first,o,u=null,v,d=[],p=[],m,y,h,_;if(a)for(_=0;_<l;_+=1)m=e[_],y=s(m,_),h=f.get(y).e,(h.f&_t)===0&&(h.nodes?.a?.measure(),(v??=new Set).add(h));for(_=0;_<l;_+=1){if(m=e[_],y=s(m,_),h=f.get(y).e,t.outrogroups!==null)for(const H of t.outrogroups)H.pending.delete(h),H.done.delete(h);if((h.f&_t)!==0)if(h.f^=_t,h===i)le(h,null,n);else{var x=u?u.next:i;h===t.effect.last&&(t.effect.last=h.prev),h.prev&&(h.prev.next=h.next),h.next&&(h.next.prev=h.prev),kt(t,u,h),kt(t,h,x),le(h,x,n),u=h,d=[],p=[],i=u.next;continue}if((h.f&Q)!==0&&(Xe(h),a&&(h.nodes?.a?.unfix(),(v??=new Set).delete(h))),h!==i){if(o!==void 0&&o.has(h)){if(d.length<p.length){var T=p[0],w;u=T.prev;var S=d[0],P=d[d.length-1];for(w=0;w<d.length;w+=1)le(d[w],T,n);for(w=0;w<p.length;w+=1)o.delete(p[w]);kt(t,S.prev,P.next),kt(t,u,S),kt(t,P,T),i=T,u=P,_-=1,d=[],p=[]}else o.delete(h),le(h,i,n),kt(t,h.prev,h.next),kt(t,h,u===null?t.effect.first:u.next),kt(t,u,h),u=h;continue}for(d=[],p=[];i!==null&&i!==h;)(o??=new Set).add(i),p.push(i),i=i.next;if(i===null)continue}(h.f&_t)===0&&d.push(h),u=h,i=h.next}if(t.outrogroups!==null){for(const H of t.outrogroups)H.pending.size===0&&(We(De(H.done)),t.outrogroups?.delete(H));t.outrogroups.size===0&&(t.outrogroups=null)}if(i!==null||o!==void 0){var C=[];if(o!==void 0)for(h of o)(h.f&Q)===0&&C.push(h);for(;i!==null;)(i.f&Q)===0&&i!==t.fallback&&C.push(i),i=i.next;var D=C.length;if(D>0){var J=(r&mn)!==0&&l===0?n:null;if(a){for(_=0;_<D;_+=1)C[_].nodes?.a?.measure();for(_=0;_<D;_+=1)C[_].nodes?.a?.fix()}_s(t,C,J)}}a&&Ie(()=>{if(v!==void 0)for(h of v)h.nodes?.a?.apply()})}function ms(t,e,n,r,s,a,l,f){var i=(l&_r)!==0?(l&xr)===0?On(n,!1,!1):jt(n):null,o=(l&gr)!==0?jt(s):null;return{v:i,i:o,e:et(()=>(a(e,i??n,o??s,f),()=>{t.delete(r)}))}}function le(t,e,n){if(t.nodes)for(var r=t.nodes.start,s=t.nodes.end,a=e&&(e.f&_t)===0?e.nodes.start:n;r!==null;){var l=ge(r);if(a.before(r),r===s)return;r=l}}function kt(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}function lr(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=lr(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function xs(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=lr(t))&&(r&&(r+=" "),r+=e);return r}function ie(t){return typeof t=="object"?xs(t):t??""}function bs(t,e,n){var r=t==null?"":""+t;return e&&(r=r?r+" "+e:e),r===""?null:r}function ys(t,e){return t==null?null:String(t)}function st(t,e,n,r,s,a){var l=t.__className;if(l!==n||l===void 0){var f=bs(n,r);f==null?t.removeAttribute("class"):t.className=f,t.__className=n}return a}function Ts(t,e,n,r){var s=t.__style;if(s!==e){var a=ys(e);a==null?t.removeAttribute("style"):t.style.cssText=a,t.__style=e}return r}function xe(t=!1){const e=L,n=e.l.u;if(!n)return;let r=()=>os(e.s);if(t){let s=0,a={};const l=Pe(()=>{let f=!1;const i=e.s;for(const o in i)i[o]!==a[o]&&(a[o]=i[o],f=!0);return f&&s++,s});r=()=>c(l)}n.b.length&&Jr(()=>{_n(e,r),ke(n.b)}),cn(()=>{const s=tn(()=>n.m.map(Er));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&cn(()=>{_n(e,r),ke(n.a)})}function _n(t,e){if(t.l.s)for(const n of t.l.s)c(n);e()}function rn(t,e,n){if(t==null)return e(void 0),n&&n(void 0),Ct;const r=tn(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const Yt=[];function ws(t,e){return{subscribe:Ut(t,e).subscribe}}function Ut(t,e=Ct){let n=null;const r=new Set;function s(f){if(An(t,f)&&(t=f,n)){const i=!Yt.length;for(const o of r)o[1](),Yt.push(o,t);if(i){for(let o=0;o<Yt.length;o+=2)Yt[o][0](Yt[o+1]);Yt.length=0}}}function a(f){s(f(t))}function l(f,i=Ct){const o=[f,i];return r.add(o),r.size===1&&(n=e(s,a)||Ct),f(t),()=>{r.delete(o),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:l}}function fr(t,e,n){const r=!Array.isArray(t),s=r?[t]:t;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return ws(n,(l,f)=>{let i=!1;const o=[];let u=0,v=Ct;const d=()=>{if(u)return;v();const m=e(r?o[0]:o,l,f);a?l(m):v=typeof m=="function"?m:Ct},p=s.map((m,y)=>rn(m,h=>{o[y]=h,u&=~(1<<y),i&&d()},()=>{u|=1<<y}));return i=!0,d(),function(){ke(p),v(),i=!1}})}function Gt(t){let e;return rn(t,n=>e=n)(),e}let He=Symbol();function at(t,e,n){const r=n[e]??={store:null,source:On(void 0),unsubscribe:Ct};if(r.store!==t&&!(He in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=Ct;else{var s=!0;r.unsubscribe=rn(t,a=>{s?r.source.v=a:At(r.source,a)}),s=!1}return t&&He in n?Gt(t):c(r.source)}function qt(){const t={};function e(){Wn(()=>{for(var n in t)t[n].unsubscribe();bn(t,He,{enumerable:!1,value:!0})})}return[t,e]}function Ss(){const{subscribe:t,set:e,update:n}=Ut({connected:!1,recording:!1,status:"ready",startTime:null,elapsed:0});let r=null;return{subscribe:t,connect(){n(s=>({...s,connected:!0,recording:!0,status:"listening",startTime:Date.now(),elapsed:0})),r=setInterval(()=>{n(s=>({...s,elapsed:s.startTime?Math.floor((Date.now()-s.startTime)/1e3):0}))},1e3)},disconnect(){r&&(clearInterval(r),r=null),n(s=>({...s,connected:!1,recording:!1,status:"disconnected"}))},setStatus(s){n(a=>({...a,status:s}))},reset(){r&&(clearInterval(r),r=null),e({connected:!1,recording:!1,status:"ready",startTime:null,elapsed:0})}}}const lt=Ss(),Es=fr(lt,t=>{const e=Math.floor(t.elapsed/60),n=t.elapsed%60;return`${e}:${n.toString().padStart(2,"0")}`}),Oe={active:!1,turnStartTs:null,sttStartTs:null,sttEndTs:null,trans1StartTs:null,trans1EndTs:null,agentStartTs:null,agentEndTs:null,trans2StartTs:null,trans2EndTs:null,ttsStartTs:null,ttsEndTs:null,transcript:"",response:""};function ks(){const{subscribe:t,set:e,update:n}=Ut(Oe);return{subscribe:t,startTurn(r){e({...Oe,active:!0,turnStartTs:r})},sttStart(r){n(s=>({...s,sttStartTs:s.sttStartTs??r}))},sttEnd(r,s){n(a=>({...a,sttEndTs:r,transcript:s}))},sttChunk(r){n(s=>({...s,transcript:r}))},trans1Start(r){n(s=>({...s,trans1StartTs:s.trans1StartTs??r}))},trans1End(r){n(s=>({...s,trans1EndTs:r}))},agentStart(r){n(s=>({...s,agentStartTs:s.agentStartTs??r}))},agentChunk(r,s){n(a=>({...a,agentStartTs:a.agentStartTs??r,agentEndTs:r,response:a.response+s}))},trans2Start(r){n(s=>({...s,trans2StartTs:s.trans2StartTs??r}))},trans2End(r){n(s=>({...s,trans2EndTs:r}))},ttsStart(r){n(s=>({...s,ttsStartTs:s.ttsStartTs??r}))},ttsChunk(r){n(s=>({...s,ttsStartTs:s.ttsStartTs??r,ttsEndTs:r}))},finishTurn(){n(r=>({...r,active:!1}))},applyTimings(r){n(s=>{if(!s.turnStartTs)return s;const a=s.turnStartTs,l=a+r.stt*1e3,f=l+r.trans_in*1e3,i=f+r.agent*1e3,o=i+r.trans_out*1e3,u=o+r.tts*1e3;return{...s,sttStartTs:a,sttEndTs:l,trans1StartTs:l,trans1EndTs:f,agentStartTs:f,agentEndTs:i,trans2StartTs:i,trans2EndTs:o,ttsStartTs:o,ttsEndTs:u}})},reset(){e(Oe)}}}function As(){const{subscribe:t,set:e,update:n}=Ut({turns:0,stt:[],trans1:[],agent:[],trans2:[],tts:[],total:[]});return{subscribe:t,recordTurn(r){const s=r.sttEndTs&&r.sttStartTs?r.sttEndTs-r.sttStartTs:null,a=r.trans1EndTs&&r.trans1StartTs?r.trans1EndTs-r.trans1StartTs:null,l=r.agentEndTs&&r.agentStartTs?r.agentEndTs-r.agentStartTs:null,f=r.trans2EndTs&&r.trans2StartTs?r.trans2EndTs-r.trans2StartTs:null,i=r.ttsEndTs&&r.ttsStartTs?r.ttsEndTs-r.ttsStartTs:null;s!==null&&a!==null&&l!==null&&f!==null&&i!==null&&n(o=>({turns:o.turns+1,stt:[...o.stt,s],trans1:[...o.trans1,a],agent:[...o.agent,l],trans2:[...o.trans2,f],tts:[...o.tts,i],total:[...o.total,s+a+l+f+i]}))},reset(){e({turns:0,stt:[],trans1:[],agent:[],trans2:[],tts:[],total:[]})}}}const R=ks(),sn=As(),Ee=Ut(null),$s=fr(sn,t=>{if(t.total.length===0)return{avg:null,min:null,max:null};const e=t.total.reduce((s,a)=>s+a,0)/t.total.length,n=Math.min(...t.total),r=Math.max(...t.total);return{avg:e,min:n,max:r}});function Cs(){const{subscribe:t,update:e,set:n}=Ut([]);let r=0;return{subscribe:t,add(s,a,l,f){const i={id:`activity-${++r}`,type:s,label:a,text:l,args:f,timestamp:new Date};e(o=>[i,...o].slice(0,50))},clear(){n([])}}}function Ms(){const{subscribe:t,update:e,set:n}=Ut([]);let r=0;return{subscribe:t,log(s){const a={id:`log-${++r}`,message:s,timestamp:new Date};e(l=>[...l,a].slice(-100))},clear(){n([])}}}const $t=Cs(),vt=Ms();var Ds=V('<header class="flex items-center justify-between mb-7"><div class="flex items-center gap-3"><span class="text-3xl">ü•™</span> <h1 class="text-2xl font-semibold tracking-tight text-gray-900">Voice Sandwich</h1></div> <div class="flex items-center gap-2 font-mono text-sm text-gray-400"><span> </span> <span></span></div></header>');function Ns(t,e){yt(e,!1);const n=()=>at(Es,"$formattedTime",s),r=()=>at(lt,"$session",s),[s,a]=qt();xe();var l=Ds(),f=b(g(l),2),i=g(f),o=g(i),u=b(i,2);mt(()=>{I(o,n()),st(u,1,`w-2 h-2 rounded-full transition-all duration-300 ${r().connected?"bg-green-500 shadow-[0_0_6px_theme(colors.green.500)]":"bg-gray-400"}`)}),O(t,l),Tt(),a()}var Rs=V(`<div class="mt-3 py-2.5 px-3.5 bg-cyan-400/10 border border-cyan-400/20 rounded-lg text-xs text-gray-600 text-center">üí° Session is active ‚Äî just speak naturally. End session when you're done.</div>`),Is=V(`<div class="bg-white rounded-2xl p-6 mb-5 border border-gray-200"><div class="flex gap-3 mb-4"><button class="flex-1 py-3.5 px-5 text-sm font-medium bg-gray-900 text-white rounded-xl
             flex items-center justify-center gap-2 transition-all duration-200
             hover:bg-gray-700 hover:-translate-y-0.5
             disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg> Start Session</button> <button class="flex-1 py-3.5 px-5 text-sm font-medium bg-gray-100 text-gray-600 rounded-xl
             border border-gray-200 transition-all duration-200
             hover:bg-gray-200 hover:border-gray-300
             disabled:opacity-50 disabled:cursor-not-allowed">End Session</button></div> <div class="flex items-center gap-2.5 py-2.5 px-3.5 bg-gray-100 rounded-lg"><span></span> <span class="text-sm font-medium text-gray-600"> </span></div> <!></div>`);function Ps(t,e){yt(e,!0);const n=()=>at(lt,"$session",s),r=()=>at(R,"$currentTurn",s),[s,a]=qt(),l={ready:{dot:"bg-cyan-400 shadow-[0_0_8px_theme(colors.cyan.400)]",text:"Ready"},connecting:{dot:"bg-gray-400",text:"Connecting..."},listening:{dot:"bg-red-500 shadow-[0_0_8px_theme(colors.red.500)] animate-pulse",text:"Listening..."},processing:{dot:"bg-blue-500 animate-pulse",text:"Processing..."},thinking:{dot:"bg-purple-500 animate-pulse",text:"Thinking..."},speaking:{dot:"bg-orange-500 shadow-[0_0_8px_theme(colors.orange.500)] animate-pulse",text:"Speaking..."},error:{dot:"bg-red-500",text:"Error"},disconnected:{dot:"bg-gray-400",text:"Disconnected"}};let f=ht(()=>{if(n().status==="listening"&&r().active){if(r().ttsStartTs)return l.speaking;if(r().agentStartTs)return l.thinking;if(r().sttEndTs)return l.processing}return l[n().status]||l.ready});var i=Is(),o=g(i),u=g(o);u.__click=function(...x){e.onStart?.apply(this,x)};var v=b(u,2);v.__click=function(...x){e.onStop?.apply(this,x)};var d=b(o,2),p=g(d),m=b(p,2),y=g(m),h=b(d,2);{var _=x=>{var T=Rs();O(x,T)};he(h,x=>{n().connected&&x(_)})}mt(()=>{u.disabled=n().connected,v.disabled=!n().connected,st(p,1,`w-2.5 h-2.5 rounded-full transition-all duration-300 ${c(f).dot??""}`),I(y,c(f).text)}),O(t,i),Tt(),a()}ir(["click"]);function nt(t){return t==null||t===0?"‚Äî":t<1e3?`${Math.round(t)}ms`:`${(t/1e3).toFixed(2)}s`}function ur(t){return t.toLocaleTimeString()}var Os=V('<div class="flex items-center justify-center gap-2 py-4 px-2 overflow-x-auto"><div class="flex flex-col items-center gap-2.5 min-w-[60px]"><div>üé§</div> <div class="text-[10px] font-medium uppercase tracking-wider text-gray-500">STT</div> <div class="font-mono text-[10px] text-gray-600"> </div></div> <div class="text-gray-600 text-sm -mt-6">‚Üí</div> <div class="flex flex-col items-center gap-2.5 min-w-[60px]"><div>üîÑ</div> <div class="text-[10px] font-medium uppercase tracking-wider text-gray-500">In‚ÜíEn</div> <div class="font-mono text-[10px] text-gray-600"> </div></div> <div class="text-gray-600 text-sm -mt-6">‚Üí</div> <div class="flex flex-col items-center gap-2.5 min-w-[60px]"><div>ü§ñ</div> <div class="text-[10px] font-medium uppercase tracking-wider text-gray-500">Agent</div> <div class="font-mono text-[10px] text-gray-600"> </div></div> <div class="text-gray-600 text-sm -mt-6">‚Üí</div> <div class="flex flex-col items-center gap-2.5 min-w-[60px]"><div>üîÑ</div> <div class="text-[10px] font-medium uppercase tracking-wider text-gray-500">En‚ÜíIn</div> <div class="font-mono text-[10px] text-gray-600"> </div></div> <div class="text-gray-600 text-sm -mt-6">‚Üí</div> <div class="flex flex-col items-center gap-2.5 min-w-[60px]"><div>üîä</div> <div class="text-[10px] font-medium uppercase tracking-wider text-gray-500">TTS</div> <div class="font-mono text-[10px] text-gray-600"> </div></div></div>');function Fs(t,e){yt(e,!0);const n=()=>at(R,"$currentTurn",r),[r,s]=qt();let a=ht(()=>({active:!!n().sttStartTs&&!n().sttEndTs,complete:!!n().sttEndTs,time:n().sttEndTs&&n().sttStartTs?nt(n().sttEndTs-n().sttStartTs):n().sttStartTs?"...":"‚Äî"})),l=ht(()=>({active:!!n().trans1StartTs&&!n().trans1EndTs,complete:!!n().trans1EndTs,time:n().trans1EndTs&&n().trans1StartTs?nt(n().trans1EndTs-n().trans1StartTs):n().trans1StartTs?"...":"‚Äî"})),f=ht(()=>({active:!!n().agentStartTs&&!n().agentEndTs,complete:!!n().agentEndTs,time:n().agentEndTs&&n().agentStartTs?nt(n().agentEndTs-n().agentStartTs):n().agentStartTs?"...":"‚Äî"})),i=ht(()=>({active:!!n().trans2StartTs&&!n().trans2EndTs,complete:!!n().trans2EndTs,time:n().trans2EndTs&&n().trans2StartTs?nt(n().trans2EndTs-n().trans2StartTs):n().trans2StartTs?"...":"‚Äî"})),o=ht(()=>({active:!!n().ttsStartTs&&!n().ttsEndTs,complete:!!n().ttsEndTs,time:n().ttsEndTs&&n().ttsStartTs?nt(n().ttsEndTs-n().ttsStartTs):n().ttsStartTs?"...":"‚Äî"}));function u(X,St){const N={cyan:{border:"border-cyan-400",active:"bg-cyan-400/15 shadow-[0_0_16px_theme(colors.cyan.400/30)]"},purple:{border:"border-purple-500",active:"bg-purple-500/15 shadow-[0_0_16px_theme(colors.purple.500/30)]"},orange:{border:"border-orange-500",active:"bg-orange-500/15 shadow-[0_0_16px_theme(colors.orange.500/30)]"},indigo:{border:"border-indigo-500",active:"bg-indigo-500/15 shadow-[0_0_16px_theme(colors.indigo.500/30)]"},emerald:{border:"border-emerald-500",active:"bg-emerald-500/15 shadow-[0_0_16px_theme(colors.emerald.500/30)]"}}[St];let A=`w-13 h-13 rounded-xl flex items-center justify-center text-2xl
                   bg-[#252530] border-2 ${N.border} transition-all duration-300`;return X.active?A+=` ${N.active} scale-105 animate-pulse`:X.complete&&(A+=" opacity-70"),A}var v=Os(),d=g(v),p=g(d),m=b(p,4),y=g(m),h=b(d,4),_=g(h),x=b(_,4),T=g(x),w=b(h,4),S=g(w),P=b(S,4),C=g(P),D=b(w,4),J=g(D),H=b(J,4),Vt=g(H),Wt=b(D,4),Ht=g(Wt),se=b(Ht,4),ae=g(se);mt((X,St,$,N,A)=>{st(p,1,X),I(y,c(a).time),st(_,1,St),I(T,c(l).time),st(S,1,$),I(C,c(f).time),st(J,1,N),I(Vt,c(i).time),st(Ht,1,A),I(ae,c(o).time)},[()=>ie(u(c(a),"cyan")),()=>ie(u(c(l),"indigo")),()=>ie(u(c(f),"purple")),()=>ie(u(c(i),"emerald")),()=>ie(u(c(o),"orange"))]),O(t,v),Tt(),s()}var Ls=V('<div class="flex items-center mb-2"><div class="w-12 flex-shrink-0 text-[10px] font-semibold uppercase tracking-wider text-gray-500"> </div> <div class="flex-1 h-5 bg-[#252530] rounded relative overflow-hidden"><div></div></div> <div class="w-14 flex-shrink-0 text-right font-mono text-[10px] text-gray-600 pl-2.5"> </div></div>'),js=V('<div class="text-center py-4 text-gray-600 text-xs">Latency data will appear here</div>'),Bs=V('<div class="mt-5 pt-5 border-t border-gray-700"><div class="flex items-center gap-2 mb-4"><span class="text-xs">‚è±</span> <span class="text-[11px] font-semibold uppercase tracking-wider text-gray-500">Latency Waterfall</span> <span class="ml-auto font-mono text-sm font-semibold text-cyan-400"> </span></div> <div class="mb-4"><!></div> <div class="flex justify-between gap-2 pt-3 border-t border-gray-700"><div class="flex flex-col items-center gap-1"><span class="text-[9px] font-semibold uppercase tracking-wider text-gray-600">Turns</span> <span class="font-mono text-sm text-gray-500"> </span></div> <div class="flex flex-col items-center gap-1"><span class="text-[9px] font-semibold uppercase tracking-wider text-gray-600">Avg Total</span> <span class="font-mono text-sm text-gray-500"> </span></div> <div class="flex flex-col items-center gap-1"><span class="text-[9px] font-semibold uppercase tracking-wider text-gray-600">Min</span> <span class="font-mono text-sm text-gray-500"> </span></div> <div class="flex flex-col items-center gap-1"><span class="text-[9px] font-semibold uppercase tracking-wider text-gray-600">Max</span> <span class="font-mono text-sm text-gray-500"> </span></div></div></div>');function Us(t,e){yt(e,!0);const n=()=>at(R,"$currentTurn",l),r=()=>at(Ee,"$waterfallData",l),s=()=>at(sn,"$latencyStats",l),a=()=>at($s,"$computedStats",l),[l,f]=qt();let i=ht(()=>n().active?n():r());function o($,N,A,F,z){if(!A)return{left:"0%",width:"0%",opacity:0};const be=Date.now(),ye=(A-$)/N*100;let zt;F?zt=F:z?zt=be:zt=A;const Te=Math.max((zt-A)/N*100,.5);return{left:`${ye}%`,width:`${Te}%`,opacity:1}}function u($,N,A){return $?!N&&A?nt(Date.now()-$):N?nt(N-$):"‚Äî":"‚Äî"}let v=ht(()=>{if(!c(i)?.turnStartTs)return null;const $=c(i).turnStartTs,N=Date.now(),A=n().active;let F=$;c(i).ttsEndTs?F=Math.max(F,c(i).ttsEndTs):c(i).trans2EndTs?F=Math.max(F,c(i).trans2EndTs):c(i).agentEndTs?F=Math.max(F,c(i).agentEndTs):c(i).trans1EndTs?F=Math.max(F,c(i).trans1EndTs):c(i).sttEndTs&&(F=Math.max(F,c(i).sttEndTs)),A&&(F=Math.max(F,N));const z=Math.max(F-$,500);return{stt:{style:o($,z,c(i).sttStartTs,c(i).sttEndTs,A&&!!c(i).sttStartTs&&!c(i).sttEndTs),duration:u(c(i).sttStartTs,c(i).sttEndTs,A&&!!c(i).sttStartTs&&!c(i).sttEndTs)},trans1:{style:o($,z,c(i).trans1StartTs,c(i).trans1EndTs,A&&!!c(i).trans1StartTs&&!c(i).trans1EndTs),duration:u(c(i).trans1StartTs,c(i).trans1EndTs,A&&!!c(i).trans1StartTs&&!c(i).trans1EndTs)},agent:{style:o($,z,c(i).agentStartTs,c(i).agentEndTs,A&&!!c(i).agentStartTs&&!c(i).agentEndTs),duration:u(c(i).agentStartTs,c(i).agentEndTs,A&&!!c(i).agentStartTs&&!c(i).agentEndTs)},trans2:{style:o($,z,c(i).trans2StartTs,c(i).trans2EndTs,A&&!!c(i).trans2StartTs&&!c(i).trans2EndTs),duration:u(c(i).trans2StartTs,c(i).trans2EndTs,A&&!!c(i).trans2StartTs&&!c(i).trans2EndTs)},tts:{style:o($,z,c(i).ttsStartTs,c(i).ttsEndTs,A&&!!c(i).ttsStartTs&&!c(i).ttsEndTs),duration:u(c(i).ttsStartTs,c(i).ttsEndTs,A&&!!c(i).ttsStartTs&&!c(i).ttsEndTs)}}}),d=ht(()=>c(i)?c(i).sttStartTs&&c(i).ttsEndTs?nt(c(i).ttsEndTs-c(i).sttStartTs):n().active&&c(i).sttStartTs?nt(Date.now()-c(i).sttStartTs):"‚Äî":"‚Äî");var p=Bs(),m=g(p),y=b(g(m),4),h=g(y),_=b(m,2),x=g(_);{var T=$=>{var N=en(),A=Qe(N);nn(A,17,()=>[{label:"STT",bar:c(v).stt,gradient:"from-cyan-400 to-cyan-500"},{label:"In‚ÜíEn",bar:c(v).trans1,gradient:"from-indigo-400 to-indigo-600"},{label:"Agent",bar:c(v).agent,gradient:"from-purple-500 to-violet-600"},{label:"En‚ÜíIn",bar:c(v).trans2,gradient:"from-emerald-400 to-emerald-600"},{label:"TTS",bar:c(v).tts,gradient:"from-orange-500 to-orange-600"}],hs,(F,z)=>{var be=Ls(),ye=g(be),zt=g(ye),Te=b(ye,2),an=g(Te),cr=b(Te,2),dr=g(cr);mt(()=>{I(zt,c(z).label),st(an,1,`absolute h-full rounded bg-gradient-to-r ${c(z).gradient??""} min-w-0.5`),Ts(an,`left: ${c(z).bar.style.left??""}; width: ${c(z).bar.style.width??""}; opacity: ${c(z).bar.style.opacity??""}`),I(dr,c(z).bar.duration)}),O(F,be)}),O($,N)},w=$=>{var N=js();O($,N)};he(x,$=>{c(v)?$(T):$(w,!1)})}var S=b(_,2),P=g(S),C=b(g(P),2),D=g(C),J=b(P,2),H=b(g(J),2),Vt=g(H),Wt=b(J,2),Ht=b(g(Wt),2),se=g(Ht),ae=b(Wt,2),X=b(g(ae),2),St=g(X);mt(($,N,A)=>{I(h,c(d)),I(D,s().turns),I(Vt,$),I(se,N),I(St,A)},[()=>a().avg?nt(a().avg):"‚Äî",()=>a().min?nt(a().min):"‚Äî",()=>a().max?nt(a().max):"‚Äî"]),O(t,p),Tt(),f()}var qs=V('<div><div class="flex items-center justify-between mb-4"><span class="text-[11px] font-semibold uppercase tracking-wider text-gray-500">Pipeline</span> <span> </span></div> <!> <!></div>');function Vs(t,e){yt(e,!1);const n=()=>at(R,"$currentTurn",r),[r,s]=qt();xe();var a=qs(),l=g(a),f=b(g(l),2),i=g(f),o=b(l,2);Fs(o,{});var u=b(o,2);Us(u,{}),mt(()=>{st(a,1,`bg-[#1a1a20] text-gray-100 rounded-2xl p-6 mb-5 transition-opacity duration-300
         ${n().active?"":"opacity-50"}`),st(f,1,`font-mono text-[11px] py-1 px-2 rounded
             ${n().active?"text-cyan-400 bg-cyan-400/15":"text-gray-600 bg-[#252530]"}`),I(i,n().active?"Turn Active":"Waiting...")}),O(t,a),Tt(),s()}var Ws=V('<div class="text-gray-400 text-sm py-5 text-center">No activity yet...</div>'),Hs=V('<pre class="mt-2 p-2 bg-black/5 rounded-md font-mono text-[11px] text-gray-600 overflow-x-auto whitespace-pre-wrap"> </pre>'),zs=V('<div class="flex items-start gap-3 p-3 bg-gray-100 rounded-xl animate-slideIn svelte-1h6jb6r"><div> </div> <div class="flex-1 min-w-0"><div> </div> <div class="text-sm text-gray-900 leading-relaxed break-words"> </div> <!> <div class="mt-1"><span class="font-mono text-[10px] text-gray-400"> </span></div></div></div>'),Ks=V('<div class="bg-white rounded-2xl p-6 mb-5 border border-gray-200"><div class="flex items-center justify-between mb-4"><span class="text-[11px] font-semibold uppercase tracking-wider text-gray-500">Activity</span> <button class="text-[11px] text-gray-400 hover:text-gray-600 transition-colors cursor-pointer">Clear</button></div> <div class="max-h-80 overflow-y-auto flex flex-col gap-2.5"><!></div></div>');function Ys(t,e){yt(e,!1);const n=()=>at($t,"$activities",r),[r,s]=qt(),a={stt:"üé§",agent:"ü§ñ",tts:"üîä",tool:"üîß"},l={stt:{bg:"bg-cyan-400/10",label:"text-cyan-400"},agent:{bg:"bg-purple-500/10",label:"text-purple-500"},tts:{bg:"bg-orange-500/10",label:"text-orange-500"},tool:{bg:"bg-blue-500/10",label:"text-blue-500"}};xe();var f=Ks(),i=g(f),o=b(g(i),2);o.__click=()=>$t.clear();var u=b(i,2),v=g(u);{var d=m=>{var y=Ws();O(m,y)},p=m=>{var y=en(),h=Qe(y);nn(h,1,n,_=>_.id,(_,x)=>{var T=zs(),w=g(T),S=g(w),P=b(w,2),C=g(P),D=g(C),J=b(C,2),H=g(J),Vt=b(J,2);{var Wt=X=>{var St=Hs(),$=g(St);mt(N=>I($,N),[()=>JSON.stringify(c(x).args,null,2)]),O(X,St)};he(Vt,X=>{c(x).args&&X(Wt)})}var Ht=b(Vt,2),se=g(Ht),ae=g(se);mt(X=>{st(w,1,`w-8 h-8 rounded-lg flex items-center justify-center text-sm flex-shrink-0 ${l[c(x).type]?.bg??""}`,"svelte-1h6jb6r"),I(S,a[c(x).type]||"üìã"),st(C,1,`text-[10px] font-semibold uppercase tracking-wider mb-0.5 ${l[c(x).type]?.label??""}`,"svelte-1h6jb6r"),I(D,c(x).label),I(H,c(x).text),I(ae,X)},[()=>ur(c(x).timestamp)]),O(_,T)}),O(m,y)};he(v,m=>{n().length===0?m(d):m(p,!1)})}O(t,f),Tt(),s()}ir(["click"]);var Gs=V('<div class="text-gray-400">Logs will appear here...</div>'),Zs=V('<div class="py-0.5 border-b border-gray-100 last:border-b-0"><span class="text-gray-400 mr-2"> </span> </div>'),Qs=V('<div class="bg-white rounded-2xl p-6 border border-gray-200"><div class="flex items-center justify-between mb-4"><span class="text-[11px] font-semibold uppercase tracking-wider text-gray-500">Console</span></div> <div class="max-h-44 overflow-y-auto font-mono text-[11px] text-gray-600 leading-relaxed"><!></div></div>');function Js(t,e){yt(e,!1);const n=()=>at(vt,"$logs",r),[r,s]=qt();xe();var a=Qs(),l=b(g(a),2),f=g(l);{var i=u=>{var v=Gs();O(u,v)},o=u=>{var v=en(),d=Qe(v);nn(d,1,n,p=>p.id,(p,m)=>{var y=Zs(),h=g(y),_=g(h),x=b(h);mt(T=>{I(_,T),I(x,` ${c(m).message??""}`)},[()=>ur(c(m).timestamp)]),O(p,y)}),O(u,v)};he(f,u=>{n().length===0?u(i):u(o,!1)})}O(t,a),Tt(),s()}const Xs=`
class PCMProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.buffer = [];
    this.targetSampleRate = 16000;
    this.resampleRatio = sampleRate / this.targetSampleRate;
    this.resampleIndex = 0;
  }

  process(inputs) {
    const input = inputs[0];
    if (!input || !input[0]) return true;

    const channelData = input[0];

    for (let i = 0; i < channelData.length; i++) {
      this.resampleIndex += 1;
      if (this.resampleIndex >= this.resampleRatio) {
        this.resampleIndex -= this.resampleRatio;
        let sample = channelData[i];
        sample = Math.max(-1, Math.min(1, sample));
        const int16 = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;
        this.buffer.push(int16);
      }
    }

    const CHUNK_SIZE = 1600;
    while (this.buffer.length >= CHUNK_SIZE) {
      const chunk = this.buffer.splice(0, CHUNK_SIZE);
      const int16Array = new Int16Array(chunk);
      this.port.postMessage(int16Array.buffer, [int16Array.buffer]);
    }

    return true;
  }
}

registerProcessor('pcm-processor', PCMProcessor);
`;function ta(){let t=null,e=null,n=null;async function r(a){if(!t){t=new AudioContext;const f=new Blob([Xs],{type:"application/javascript"}),i=URL.createObjectURL(f);await t.audioWorklet.addModule(i),URL.revokeObjectURL(i)}t.state==="suspended"&&await t.resume(),n=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});const l=t.createMediaStreamSource(n);e=new AudioWorkletNode(t,"pcm-processor"),e.port.onmessage=f=>{a(f.data)},l.connect(e)}function s(){e&&(e.disconnect(),e=null),n&&(n.getTracks().forEach(a=>a.stop()),n=null)}return{start:r,stop:s}}const gn=24e3;function ea(t){let e=null,n=0,r=[],s=[],a=!1,l=0;function f(_){const x=l>0;l+=_;const T=l>0;x!==T&&t?.(T)}function i(){return e||(e=new AudioContext({sampleRate:gn})),e.state==="suspended"&&e.resume(),e}function o(_){const x=atob(_),T=new ArrayBuffer(x.length),w=new Uint8Array(T);for(let S=0;S<x.length;S++)w[S]=x.charCodeAt(S);return{arrayBuffer:T,length:w.length}}function u(_,x){const T=i(),w=new DataView(_),S=T.createBuffer(1,x/2,gn),P=S.getChannelData(0);for(let C=0;C<x;C+=2){const D=w.getInt16(C,!0);P[C/2]=D/32768}return S}function v(_){_.start(n),_.addEventListener("ended",()=>d(_))}function d(_){const x=r.indexOf(_);x>-1&&r.splice(x,1)}function p(){if(a)return;a=!0;const _=async()=>{if(s.length===0){a=!1;return}const T=s.shift();if(!T){p();return}try{const w=i();let S;if(typeof T=="string"){const P=o(T),C=u(P.arrayBuffer,P.length);x(C,w);return}else{S=T;const P=await w.decodeAudioData(S);x(P,w)}}catch(w){console.error("Error processing audio chunk:",w),_()}},x=(T,w)=>{const S=w.createBufferSource();S.buffer=T,S.connect(w.destination),r.push(S),f(1),S.onended=()=>{f(-1)},n<w.currentTime&&(n=w.currentTime),v(S),n+=T.duration,_()};_()}function m(_){s.push(_),p()}function y(){s=[];for(const _ of r)try{_.stop()}catch{}r=[],n=0}function h(){n=0}return{push:m,stop:y,resetScheduling:h}}let Fe=!1;function na(){const t=ea(o=>{!o&&Fe&&(r=!1,Fe=!1,console.log("Turn finished: TTS Complete & Audio Ended -> Mic Unmuted"),l())}),e=ta();let n=null,r=!1,s=null;function a(o){const u=Gt(R);switch(o.type){case"user_input":r=!0,R.startTurn(o.ts);break;case"processing_start":r=!0;const v=Date.now(),d=Gt(R);d.active&&d.turnStartTs?Ee.set({...d}):d.turnStartTs&&Ee.set({...d}),R.startTurn(v),console.log("Turn Started (Server VAD)");break;case"timings":R.applyTimings(o.data);break;case"tts_complete":Fe=!0,console.log("TTS Generation Complete signal received");break;case"stt_chunk":u.active||R.startTurn(o.ts||Date.now()),R.sttStart(o.ts),R.sttChunk(o.transcript);break;case"stt_output":R.sttEnd(o.ts,o.transcript),$t.add("stt","Transcription",o.transcript);break;case"translation":o.direction==="indic_to_en"?o.text?(R.trans1End(o.ts),$t.add("stt","Translation (In‚ÜíEn)",o.text)):R.trans1Start(o.ts):o.text?(R.trans2End(o.ts),$t.add("agent","Translation (En‚ÜíIn)",o.text)):R.trans2Start(o.ts);break;case"agent_chunk":R.agentChunk(o.ts,o.text);break;case"tool_call":$t.add("tool",`Tool: ${o.name}`,"Called with arguments:",o.args),vt.log(`Tool call: ${o.name}`);break;case"tool_result":$t.add("tool",`Tool Result: ${o.name}`,o.result),vt.log(`Tool result: ${o.result}`);break;case"tts_chunk":{const p=Gt(R);!p.ttsStartTs&&p.response&&$t.add("agent","Agent Response",p.response),R.ttsChunk(o.ts),s&&clearTimeout(s),s=setTimeout(()=>{},1e3);break}}}function l(){console.log("Finishing turn, updating stats...");const o=Gt(R);Ee.set({...o}),sn.recordTurn(o),R.finishTurn()}async function f(){if(n?.readyState===WebSocket.OPEN)return;lt.setStatus("connecting");const u=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;n=new WebSocket(u),n.binaryType="arraybuffer",n.onopen=async()=>{lt.connect(),vt.log("Session started");try{await e.start(v=>{!r&&Gt(lt).connected&&n?.readyState===WebSocket.OPEN&&n.send(v)}),vt.log("Microphone access granted")}catch(v){console.error(v),vt.log(`Error: ${v instanceof Error?v.message:"Unknown error"}`),lt.setStatus("error"),i()}},n.onmessage=async v=>{if(v.data instanceof ArrayBuffer)t.push(v.data);else try{const d=JSON.parse(v.data);a(d)}catch{console.error("Failed to parse WebSocket message:",v.data)}},n.onclose=()=>{lt.disconnect(),vt.log("WebSocket disconnected")},n.onerror=v=>{console.error(v),vt.log("WebSocket error"),lt.setStatus("error")}}function i(){vt.log("Session ended"),s&&(clearTimeout(s),s=null),t.stop(),e.stop(),n&&(n.close(),n=null),lt.reset()}return{start:f,stop:i}}var ra=V('<div class="max-w-3xl mx-auto"><!> <!> <!> <!> <!></div>');function sa(t,e){yt(e,!1);const n=na();xe();var r=ra(),s=g(r);Ns(s,{});var a=b(s,2);Ps(a,{onStart:()=>n.start(),onStop:()=>n.stop()});var l=b(a,2);Vs(l,{});var f=b(l,2);Ys(f,{});var i=b(f,2);Js(i,{}),O(t,r),Tt()}cs(sa,{target:document.getElementById("app")});
